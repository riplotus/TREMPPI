<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>Tremmpi browse</title>
        <meta charset="UTF-8">
        <script src="./browse/vendor/jquery.min.js"></script>
        <script>
            var tremmpi_browse = {};

            var factory = function(name) {
                return function() {
                    console.log(name);
                    $("#frame").attr("src", name + ".html");
                };
            };

            var readFiles = function() {
                $.ajax(
                        {url: "http://localhost:8080/?files",
                            success: function(result) {
                                $("#files").empty();
                                if (!result)
                                    return;
                                var res = result.split("\n");
                                for (var i = 0; i < res.length; i++) {
                                    res[i] = res[i].slice(0, -5);
                                    $("#files").append(
                                            '<div class="page_content" id="' + res[i] + '">' + res[i] + '</div>'
                                            );
                                    $("#" + res[i]).click(factory(res[i]));
                                }
                            },
                            error: function(jqXHR, textStatus, errorThrown) {
                                $("#files").html('ERROR: could not load the files. TREMPPI browser must be executed through the "tremppi browse" command');
                            }
                        }
                );
            };

            // Read the files, repeat every second
            readFiles();
            setInterval(function() {
                readFiles();
            }, 1000);
        </script>

        <link rel="stylesheet" type="text/css" href="browse/local/css.css">
    </head>
    <body style="padding: 0px; margin: 0px; height: 100%">

        <div id="files" style="
             position: absolute;
             width: 190px; height: 100%;
             background-color: #DDDDDD;
             padding: 0px 5px;
             margin: 0px;" >
            no files loaded
        </div>
        <div style="margin: 0px 0px 0px 200px; height: 100%; ">
            <iframe id="frame" style="display:block; width:100%; height: 100%; border:0px; "></iframe>
        </div>
    </body>
</html>
